<!DOCTYPE html>
<html>
<head>
    <title>Task Dashboard</title>
    <style>
        body {
            font-family: Arial;
            background: #0d0d0d;
            color: #00ff99;
            padding: 20px;
        }
        .task {
            margin: 10px 0;
            padding: 12px;
            background: #1a1a1a;
            border: 1px solid #00ff99;
            display: flex;
            justify-content: space-between;
            border-radius: 8px;
        }
        button {
            background: #00ff99;
            border: none;
            padding: 6px 10px;
            cursor: pointer;
            font-weight: bold;
            border-radius: 6px;
        }
        input, select {
            padding: 6px;
            border-radius: 6px;
            border: 1px solid #00ff99;
            background: #111;
            color: #00ff99;
        }
    </style>
</head>

<body>

    <h1>‚ö° Automation Dashboard</h1>

    <h2>Add Task</h2>
    <input id="title" placeholder="Task name">
    <select id="category">
        <option>general</option>
        <option>work</option>
        <option>health</option>
    </select>
    <select id="priority">
        <option>low</option>
        <option>medium</option>
        <option>high</option>
    </select>
    <button onclick="addTask()">Add</button>

    <h2>Tasks</h2>
    <div id="taskList"></div>

<script>
const API_URL = "/tasks"

async function loadTasks() {
    const res = await fetch(API_URL)
    const tasks = await res.json()

    const container = document.getElementById("taskList")
    container.innerHTML = ""

    tasks.forEach(t => {
        container.innerHTML += `
            <div class="task">
                <div>
                    <strong>${t.title}</strong><br>
                    <small>${t.category} / ${t.priority}</small>
                </div>
                <div>
                    <button onclick="toggleTask('${t.id}')">
                        ${t.completed ? "‚òë" : "‚òê"}
                    </button>
                    <button onclick="deleteTask('${t.id}')">üóë</button>
                </div>
            </div>
        `
    })
}

async function addTask() {
    const title = document.getElementById("title").value
    const category = document.getElementById("category").value
    const priority = document.getElementById("priority").value

    await fetch(API_URL, {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({ title, category, priority })
    })

    loadTasks()
}

async function toggleTask(id) {
    await fetch(`${API_URL}/${id}/toggle`, { method: "PATCH" })
    loadTasks()
}

async function deleteTask(id) {
    await fetch(`${API_URL}/${id}`, { method: "DELETE" })
    loadTasks()
}

loadTasks()
</script>

</body>
</html>
